"use strict";(self.webpackChunkAskPDF_frontend=self.webpackChunkAskPDF_frontend||[]).push([[553],{3553:function(e,n,s){s.r(n),s.d(n,{default:function(){return W}});var i=s(7762),t=s(9439),o=s(1413),r=s(1632),a=s(9806),c=s(3394),l=s(1975),u=s(2791),d=s(7224),m=s(9626),h=s(6920),j=s(211),p=s(7850),f=s(184);function x(e){var n=e.title,s=e.onClick,i=e.onDelete,o=e.active,c=void 0!==o&&o,l=(0,u.useState)(!1),d=(0,t.Z)(l,2),m=d[0],x=d[1];return(0,f.jsxs)("div",{role:"button",className:["chat-label",c&&"active"].join(" "),onClick:s,children:[(0,f.jsx)(h.Z,{icon:j.Z,stroke:1.25})," ",n,(0,f.jsx)("span",{className:"delete",onClick:function(){x(!0),"function"===typeof i&&i((function(){x(!1)}))},children:m?(0,f.jsx)(a.G,{icon:r.IJ7,spin:!0}):(0,f.jsx)(h.Z,{icon:p.Z,stroke:1.25})})]})}var g=s(3433),v=s(3257),A="data:image/png;base64,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";function b(e){var n=e.content.split("\n").map((function(e,n){return(0,f.jsx)("p",{children:e},n)}));return(0,f.jsxs)("div",{className:"message ai-message",children:[(0,f.jsx)("img",{src:A,className:"avatar"}),n]})}function C(e){var n=e.content;return(0,f.jsx)("div",{className:"message user-message",children:n})}var D=s(1233),w=s(138),Z=s(9085),S=s(1933),N=s(9128),y=s(2670);function O(e){var n=e.content;return(0,f.jsxs)("div",{className:"message ai-message",children:[(0,f.jsx)(y.Z,{size:"sm"})," ",n||" Thinking..."]})}var M=s(476),k=s(2576),E=s(3948),z=s(1811);function Q(e){var n=e.uuid,s=(0,d.FO)().isDemo,i=(0,d.v$)("demo_sub"),r=(0,t.Z)(i,2),a=r[0],c=r[1],l=a(),m=(0,S.useQueryClient)(),j=(0,w.ZP)(n),x=j.isLoading,A=j.isError,y=j.error,Q=j.chat,B=(0,u.useState)([]),J=(0,t.Z)(B,2),U=J[0],I=J[1],R=(0,u.useState)(""),G=(0,t.Z)(R,2),F=G[0],P=G[1],Y=(0,u.useState)(!1),W=(0,t.Z)(Y,2),T=W[0],H=W[1],K=(0,u.useState)(!1),q=(0,t.Z)(K,2),X=q[0],L=q[1],V=(0,d.bg)(),_=(0,t.Z)(V,2),$=_[0],ee=_[1];(0,u.useEffect)((function(){if(null!==Q&&void 0!==Q&&Q.chat_history)try{var e=[];JSON.parse(null===Q||void 0===Q?void 0:Q.chat_history).map((function(n,s){"ai"===n.type?e[s]=(0,f.jsx)(b,{content:n.content},s):e[s]=(0,f.jsx)(C,{content:n.content},s)})),I(e)}catch(y){console.log("error parsing chat history")}else I([]);ee()}),[x,Q]),(0,u.useEffect)((function(){ee()}),[]);var ne=(0,u.useCallback)((function(e){return e.preventDefault(),F.trim()?s&&(null===l||void 0===l?void 0:l.questions)<=0?Z.Am.warning("The demo quota is exceeded, please wait 12 hours \ud83d\ude4f"):(H(!0),I((function(e){return[].concat((0,g.Z)(e),[(0,f.jsx)(C,{content:F},Math.random()),(0,f.jsx)(O,{},Math.random())])})),P(""),ee(),void(0,N.u3)(n,F).then((function(e){if(null!==e&&void 0!==e&&e.errors)Z.Am.error(e.message),I((function(e){return e.slice(0,-1)}));else{var n,i,t=null===e||void 0===e||null===(n=e.response)||void 0===n||null===(i=n.output)||void 0===i?void 0:i.trim();t||Z.Am.error("OpenAI servers are overloaded, please try again or later"),I((function(e){return[].concat((0,g.Z)(e.slice(0,-1)),[(0,f.jsx)(b,{content:t},Math.random())])})),m.invalidateQueries("user.subscription"),s&&c((function(e){return(0,o.Z)((0,o.Z)({},e),{},{questions:e.questions-1})}))}})).catch((function(e){var n,s,i,t;null!==(n=e.response)&&void 0!==n&&null!==(s=n.data)&&void 0!==s&&s.message?Z.Am.warning(null===(i=e.response)||void 0===i||null===(t=i.data)||void 0===t?void 0:t.message):Z.Am.error(e.message);I((function(e){return e.slice(0,-1)}))})).finally((function(){H(!1),m.invalidateQueries("user.chat.".concat(n)),ee()}))):Z.Am.warning("Please ask something.")}),[n,F]),se=(0,u.useCallback)((function(e){(0,N.tY)(n).then((function(e){console.log("prompt stopped")})).catch((function(e){var n,s;422===e.response.status||400===e.response.status?Z.Am.warning(null===(n=e.response)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.message):Z.Am.error(e.message)})).finally((function(){})),H(!1),I((function(e){return e.slice(0,-1)}))}),[n]),ie=(0,u.useCallback)((function(){L(!0),(0,N.zR)(n).then((function(e){204===e.status?(Z.Am.success("Cleared successfully."),m.invalidateQueries("user.chat.".concat(n)),I([])):Z.Am.warning("Something went wrong!")})).catch((function(e){Z.Am.error(e)})).finally((function(){L(!1)}))}),[n]);return x?(0,f.jsx)(D.Z,{center:!0}):(A&&Z.Am.error(y),(0,f.jsxs)(f.Fragment,{children:[(0,f.jsx)("div",{className:"chats flex-grow-1 d-flex align-items-end",children:(0,f.jsx)("div",{className:"container px-4",children:U.map((function(e,n){return e}))})}),(0,f.jsxs)("div",{className:"container prompt-input d-flex gap-2 pt-5 pb-4 px-4",ref:$,children:[(0,f.jsx)("form",{onSubmit:ne,className:"flex-grow-1",children:(0,f.jsx)("input",{type:"text",value:F,onChange:function(e){return P(e.target.value)},className:"form-control form-control-lg",placeholder:"Ask your document a question?"})}),(0,f.jsx)(M.Z,{placement:"top",delay:{show:250,hide:400},overlay:function(e){return(0,f.jsx)(k.Z,(0,o.Z)((0,o.Z)({id:"button-tooltip"},e),{},{children:T?"Stop":"Send"}))},children:(0,f.jsx)(v.Z,{disabled:!F&&!T,className:["btn btn-sm send",T?"btn-danger":"btn-primary"].join(" "),title:T?"Stop":"Send",onClick:function(e){if(T)return se(e);ne(e)},children:T?(0,f.jsx)(h.Z,{icon:E.Z}):(0,f.jsx)(h.Z,{icon:z.Z})})}),(0,f.jsx)(M.Z,{placement:"top",delay:{show:250,hide:400},overlay:function(e){return(0,f.jsx)(k.Z,(0,o.Z)((0,o.Z)({id:"button-tooltip"},e),{},{children:"Clear Chat History"}))},children:(0,f.jsx)(v.Z,{className:"btn btn-outline-secondary clear-history",isLoading:X,title:"Clear Chat History",onClick:ie,children:(0,f.jsx)(h.Z,{icon:p.Z})})})]}),(0,f.jsx)("div",{className:"container px-4 mb-2",children:(0,f.jsxs)("small",{children:[(0,f.jsx)("b",{children:"Note:"})," if the chat bot didn't know how to access to document or where to look up, just tell him \"",(0,f.jsx)("b",{children:(0,f.jsx)("i",{children:"from document?"})}),'".']})})]}))}var B=s(7689),J=s(1087),U=s(5480),I=s(6334),R=s(9396),G=s(8241),F=s(319),P=function(e){var n=e.files,s=e.setProgress,i=e.setIsSuccessUpload,t=e.resetDropzone,r=(e.name,e.createChatRoom),a=e.setProcessing,c=e.subscription,l=e.isDemo,u=e.demoSubscription,d=e.setDemoSubscription,m=e.queryClient;if(l&&u.pdfs<=0)return t(),Z.Am.warning("The demo quota is exceeded, please wait 12 hours \ud83d\ude4f");if(!l){if(1!==(null===c||void 0===c?void 0:c.status))return t(),Z.Am.warning("You need a valid subscription to continue.");if((null===c||void 0===c?void 0:c.pdfs)<=0)return t(),Z.Am.warning("You have reached the maximum number of document uploads.")}(0,R.cT)("user/chat",n[0],{onUploadProgress:function(e){var n=e.loaded/e.total*100;s(n),n>=100&&a(!0)}}).then((function(e){var n;if(!e.data||null!==(n=e.data)&&void 0!==n&&n.errors){var s;Z.Am.error(null===(s=e.data)||void 0===s?void 0:s.message),t()}else{var a=e.data.chat_room;r(a.uuid,a.title),i(!0),setTimeout((function(){t()}),5e3),l&&d((function(e){return(0,o.Z)((0,o.Z)({},e),{},{pdfs:e.pdfs-1})})),m.invalidateQueries("user.subscription")}})).catch((function(e){var n,s;422===e.response.status||400==e.response.status?Z.Am.warning(null===(n=e.response)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.message):Z.Am.error(e.message);t()})).finally((function(){a(!1)}))},Y=function(e){Z.Am.error("Invalid document!")};function W(){var e=(0,d.FO)().isDemo,n=(0,d.v$)("demo_sub",{pdfs:2,questions:10,created_at:(new Date).getTime()}),s=(0,t.Z)(n,2),o=s[0],j=s[1],p=e?o():null,g=(0,d.Wn)().isExtendedLicense,v=(0,u.useState)(!1),A=(0,t.Z)(v,2),b=A[0],C=A[1],D=(0,u.useState)(!1),O=(0,t.Z)(D,2),M=O[0],k=(O[1],(0,d.OR)("resize",window.innerWidth,(function(){return window.innerWidth}))),E=(0,t.Z)(k,2),z=E[0],R=(E[1],(0,U.A)().user),W=(0,w.SI)(),T=W.isLoading,H=W.subscription,K=(0,S.useQueryClient)(),q=(0,B.s0)(),X=(0,B.UO)().uuid,L=(0,u.useState)(X),V=(0,t.Z)(L,2),_=V[0],$=V[1],ee=(0,w.z$)(),ne=ee.isLoading,se=ee.isError,ie=ee.error,te=ee.userChatRoomList,oe=(0,u.useState)(!1),re=(0,t.Z)(oe,2),ae=re[0],ce=re[1];(0,u.useEffect)((function(){X!==_&&q("/playground/".concat(_))}),[_]);var le=(0,u.useCallback)((function(e){$(e),q("/playground/".concat(e))}),[X]),ue=(0,u.useCallback)((function(e,n){K.invalidateQueries("user.chat.list"),$(e),q("/playground/".concat(e))}),[X]),de=(0,u.useCallback)((function(e,n){var s="";if(te){var t,o=(0,i.Z)(te);try{for(o.s();!(t=o.n()).done;){var r=t.value;if((null===r||void 0===r?void 0:r.uuid)!==e){s=null===r||void 0===r?void 0:r.uuid;break}}}catch(a){o.e(a)}finally{o.f()}}(0,N.U1)(e).then((function(e){204===e.status?(Z.Am.success("Deleted successfully."),K.invalidateQueries("user.chat.list").then((function(){s&&$(s)}))):Z.Am.warning("Something went wrong!")})).catch((function(e){Z.Am.error(e)})).finally((function(){n()}))}),[X,te]);return(0,u.useEffect)((function(){var e,n;X&&_||void 0===te||!Object.keys(te).length?void 0===te||Object.keys(te).length||($(""),q("/playground")):(q("/playground/".concat(null===(e=te[0])||void 0===e?void 0:e.uuid)),$(null===(n=te[0])||void 0===n?void 0:n.uuid))}),[X,te]),(0,u.useEffect)((function(){(new Date).getTime()-(null===p||void 0===p?void 0:p.created_at)>432e5&&j({pdfs:2,questions:10,created_at:(new Date).getTime()})}),[]),se&&Z.Am.error(ie),!Object.keys(R).length||ne||T?(0,f.jsx)(I.Z,{}):(0,f.jsx)(f.Fragment,{children:(0,f.jsxs)("main",{className:"playground",children:[(0,f.jsx)(l.YE,{width:"290px",toggled:b,collapsed:M,breakPoint:"md",onBackdropClick:function(){return C(!b)},backgroundColor:"",className:"",children:(0,f.jsxs)("div",{className:"playground-sidebar",children:[!(null===te||void 0===te||!te.length)&&(H||p)&&(0,f.jsx)(c.Z,{onUpload:P,onError:Y,name:"pdf-file",extraOnUploadProps:{createChatRoom:ue,setProcessing:ce,subscription:H,isDemo:e,demoSubscription:p,setDemoSubscription:j,queryClient:K},dropzoneOptions:{accept:{"application/pdf":[".pdf"]},maxSize:52428800},children:ae?(0,f.jsx)("div",{className:"text-center",children:(0,f.jsxs)("b",{children:[(0,f.jsx)(y.Z,{size:"sm"})," Processing..."]})}):M?(0,f.jsx)(a.G,{icon:r.r8p}):(0,f.jsxs)("div",{className:"text-center",children:[(0,f.jsxs)("b",{children:[(0,f.jsx)(a.G,{icon:r.r8p})," New Chat"]}),(0,f.jsx)("p",{children:"Drag & Drop your PDF"})]})}),(0,f.jsx)("div",{className:"chat-labels-list my-3",children:null===te||void 0===te?void 0:te.map((function(e,n){return(0,f.jsx)(x,{title:e.title,onClick:function(){return le(e.uuid)},onDelete:function(n){return de(e.uuid,n)},active:e.uuid===_},n)}))}),(0,f.jsxs)("div",{className:"sidebar-bottom-section",children:[e&&(0,f.jsxs)(f.Fragment,{children:[((null===H||void 0===H?void 0:H.questions)<=20||(null===H||void 0===H?void 0:H.pdfs)<=10)&&(0,f.jsxs)(J.rU,{to:"/pricing",className:"btn btn-warning btn-lg btn-block",children:[(0,f.jsx)(h.Z,{icon:G.Z,stroke:1.5,size:30})," Upgrade"]}),(0,f.jsxs)("div",{className:"quota",children:[(0,f.jsx)("small",{children:"- Quota limited for demo only."}),(0,f.jsx)("br",{}),(0,f.jsx)("small",{children:"- Quota reset every 12 hours."}),(0,f.jsx)("h3",{className:"h6",children:"Quota:"}),(0,f.jsxs)("span",{children:[null===p||void 0===p?void 0:p.pdfs," PDFs"]}),(0,f.jsx)("br",{}),(0,f.jsxs)("span",{children:["Max PDF size: ",null===H||void 0===H?void 0:H.pdf_size,"MB/pdf"]}),(0,f.jsx)("br",{}),(0,f.jsxs)("span",{children:[null===p||void 0===p?void 0:p.questions," PDF Questions"]}),(0,f.jsx)("br",{})]})]}),H&&g&&!e&&(0,f.jsxs)(f.Fragment,{children:[((null===H||void 0===H?void 0:H.questions)<=20||(null===H||void 0===H?void 0:H.pdfs)<=10)&&(0,f.jsxs)(J.rU,{to:"/pricing",className:"btn btn-warning btn-lg btn-block",children:[(0,f.jsx)(h.Z,{icon:G.Z,stroke:1.5,size:30})," Upgrade"]}),(0,f.jsxs)("div",{className:"quota",children:[(0,f.jsx)("h3",{className:"h6",children:"Available Subscription Quota:"}),(0,f.jsxs)("span",{children:[null===H||void 0===H?void 0:H.pdfs," PDFs left."]}),(0,f.jsx)("br",{}),(0,f.jsxs)("span",{children:["Max PDF size: ",null===H||void 0===H?void 0:H.pdf_size,"MB/pdf."]}),(0,f.jsx)("br",{}),(0,f.jsxs)("span",{children:[null===H||void 0===H?void 0:H.questions," PDF Questions left."]}),(0,f.jsx)("br",{})]})]}),R&&(0,f.jsxs)("div",{className:"profile",onClick:function(){return q("/account/settings")},children:[(0,f.jsx)(m.Z,{username:R.username,size:45}),(0,f.jsxs)("div",{children:[(0,f.jsx)("b",{children:R.username}),(0,f.jsx)("br",{}),(0,f.jsxs)("span",{children:["(",R.email,")"]})]}),(0,f.jsx)("div",{className:"",children:(0,f.jsx)(a.G,{icon:r._tD})})]})]})]})}),(0,f.jsxs)("section",{className:"playground-chat-section",children:[z<=768&&(0,f.jsx)("button",{type:"button",onClick:function(){return C((function(e){return!e}))},className:"btn btn-light toggle-sidebar-button text-primary",children:(0,f.jsx)(a.G,{icon:r.Ljc})}),(0,f.jsxs)("section",{className:"d-flex flex-column",children:[g?H&&1==(null===H||void 0===H?void 0:H.status)||e?(null===H||void 0===H?void 0:H.questions)<=0?(0,f.jsxs)("div",{className:"d-flex flex-column justify-content-start p-5",children:["Your subscription has reached its maximum usage.",(0,f.jsx)(J.rU,{to:"/pricing",className:"btn btn-warning my-3",children:"Upgrade Now?"})]}):_&&(0,f.jsx)(Q,{uuid:_},_):(0,f.jsxs)("div",{className:"d-flex flex-column justify-content-start p-5 mt-3",children:["You need to have a subscription in order to be able to use the Playground section.",(0,f.jsx)(J.rU,{to:"/pricing",className:"btn btn-warning my-3",children:"Get a subscription now?"})]}):_&&(0,f.jsx)(Q,{uuid:_},_),!_&&(0,f.jsx)("div",{className:"d-flex justify-content-center align-items-center h-100",children:(0,f.jsx)("div",{className:"w-50",children:(H||p)&&(0,f.jsxs)("div",{className:"text-center",children:[(0,f.jsx)("h3",{children:"Upload your PDF to chat with."}),(0,f.jsx)(c.Z,{onUpload:P,onError:Y,name:"pdf-file",extraOnUploadProps:{createChatRoom:ue,setProcessing:ce,subscription:H,isDemo:e,demoSubscription:p,setDemoSubscription:j,queryClient:K},dropzoneOptions:{accept:{"application/pdf":[".pdf"]},maxSize:52428800},children:ae?(0,f.jsx)("div",{className:"text-center",children:(0,f.jsxs)("b",{children:[(0,f.jsx)(y.Z,{size:"sm"})," Processing..."]})}):M?(0,f.jsx)(a.G,{icon:r.r8p}):(0,f.jsxs)("div",{className:"text-center",children:[(0,f.jsxs)("b",{children:[(0,f.jsx)(h.Z,{icon:F.Z,size:40}),(0,f.jsx)("br",{})," Upload you PDF"]}),(0,f.jsx)("p",{children:"(Drag & Drop)"})]})})]})})})]})]})]})})}}}]);
//# sourceMappingURL=553.95c4be96.chunk.js.map