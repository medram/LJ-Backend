"use strict";(self.webpackChunkAskPDF_frontend=self.webpackChunkAskPDF_frontend||[]).push([[553],{3553:function(e,n,s){s.r(n),s.d(n,{default:function(){return H}});var i=s(7762),t=s(9439),o=s(1413),r=s(1632),a=s(9806),c=s(3394),l=s(1975),u=s(2791),d=s(7224),m=s(9626),h=s(6920),j=s(211),x=s(7850),p=s(184);function f(e){var n=e.title,s=e.onClick,i=e.onDelete,o=e.active,c=void 0!==o&&o,l=(0,u.useState)(!1),d=(0,t.Z)(l,2),m=d[0],f=d[1];return(0,p.jsxs)("div",{role:"button",className:["chat-label",c&&"active"].join(" "),onClick:s,children:[(0,p.jsx)(h.Z,{icon:j.Z,stroke:1.25})," ",n,(0,p.jsx)("span",{className:"delete",onClick:function(){f(!0),"function"===typeof i&&i((function(){f(!1)}))},children:m?(0,p.jsx)(a.G,{icon:r.IJ7,spin:!0}):(0,p.jsx)(h.Z,{icon:x.Z,stroke:1.25})})]})}var g=s(3433),v=s(3257),A="data:image/png;base64,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",b=s(7592);function C(e){var n=e.content;return(0,p.jsxs)("div",{className:"message ai-message",children:[(0,p.jsx)("img",{src:A,className:"avatar"}),(0,p.jsx)(b.U,{children:n})]})}function D(e){var n=e.content;return(0,p.jsx)("div",{className:"message user-message",children:n})}var w=s(1233),Z=s(138),S=s(9085),N=s(1933),y=s(9128),O=s(2670);function M(e){var n=e.content;return(0,p.jsxs)("div",{className:"message ai-message",children:[(0,p.jsx)(O.Z,{size:"sm"})," ",n||" Thinking..."]})}var k=s(476),E=s(2576),z=s(3948),Q=s(1811);function B(e){var n=e.uuid,s=(0,d.FO)().isDemo,i=(0,d.v$)("demo_sub"),r=(0,t.Z)(i,2),a=r[0],c=r[1],l=a(),m=(0,N.useQueryClient)(),j=(0,Z.ZP)(n),f=j.isLoading,A=j.isError,b=j.error,O=j.chat,B=(0,u.useState)([]),J=(0,t.Z)(B,2),U=J[0],I=J[1],G=(0,u.useState)(""),R=(0,t.Z)(G,2),F=R[0],P=R[1],Y=(0,u.useState)(!1),W=(0,t.Z)(Y,2),T=W[0],H=W[1],K=(0,u.useState)(!1),q=(0,t.Z)(K,2),X=q[0],L=q[1],V=(0,d.bg)(),_=(0,t.Z)(V,2),$=_[0],ee=_[1];(0,u.useEffect)((function(){if(null!==O&&void 0!==O&&O.chat_history)try{var e=[];JSON.parse(null===O||void 0===O?void 0:O.chat_history).map((function(n,s){"ai"===n.type?e[s]=(0,p.jsx)(C,{content:n.content},s):e[s]=(0,p.jsx)(D,{content:n.content},s)})),I(e)}catch(b){console.log("error parsing chat history")}else I([]);ee()}),[f,O]),(0,u.useEffect)((function(){ee()}),[]);var ne=(0,u.useCallback)((function(e){return e.preventDefault(),F.trim()?s&&(null===l||void 0===l?void 0:l.questions)<=0?S.Am.warning("The demo quota is exceeded, please wait 12 hours \ud83d\ude4f"):(H(!0),I((function(e){return[].concat((0,g.Z)(e),[(0,p.jsx)(D,{content:F},Math.random()),(0,p.jsx)(M,{},Math.random())])})),P(""),ee(),void(0,y.u3)(n,F).then((function(e){if(null!==e&&void 0!==e&&e.errors)S.Am.error(e.message),I((function(e){return e.slice(0,-1)}));else{var n,i,t=null===e||void 0===e||null===(n=e.response)||void 0===n||null===(i=n.output)||void 0===i?void 0:i.trim();t||S.Am.error("OpenAI servers are overloaded, please try again or later"),I((function(e){return[].concat((0,g.Z)(e.slice(0,-1)),[(0,p.jsx)(C,{content:t},Math.random())])})),m.invalidateQueries("user.subscription"),s&&c((function(e){return(0,o.Z)((0,o.Z)({},e),{},{questions:e.questions-1})}))}})).catch((function(e){var n,s,i,t;null!==(n=e.response)&&void 0!==n&&null!==(s=n.data)&&void 0!==s&&s.message?S.Am.warning(null===(i=e.response)||void 0===i||null===(t=i.data)||void 0===t?void 0:t.message):S.Am.error(e.message);I((function(e){return e.slice(0,-1)}))})).finally((function(){H(!1),m.invalidateQueries("user.chat.".concat(n)),ee()}))):S.Am.warning("Please ask something.")}),[n,F]),se=(0,u.useCallback)((function(e){(0,y.tY)(n).then((function(e){console.log("prompt stopped")})).catch((function(e){var n,s;422===e.response.status||400===e.response.status?S.Am.warning(null===(n=e.response)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.message):S.Am.error(e.message)})).finally((function(){})),H(!1),I((function(e){return e.slice(0,-1)}))}),[n]),ie=(0,u.useCallback)((function(){L(!0),(0,y.zR)(n).then((function(e){204===e.status?(S.Am.success("Cleared successfully."),m.invalidateQueries("user.chat.".concat(n)),I([])):S.Am.warning("Something went wrong!")})).catch((function(e){S.Am.error(e)})).finally((function(){L(!1)}))}),[n]);return f?(0,p.jsx)(w.Z,{center:!0}):(A&&S.Am.error(b),(0,p.jsxs)(p.Fragment,{children:[(0,p.jsx)("div",{className:"chats flex-grow-1 d-flex align-items-end",children:(0,p.jsx)("div",{className:"container px-4",children:U.map((function(e,n){return e}))})}),(0,p.jsxs)("div",{className:"container prompt-input d-flex gap-2 pt-5 pb-4 px-4",ref:$,children:[(0,p.jsx)("form",{onSubmit:ne,className:"flex-grow-1",children:(0,p.jsx)("input",{type:"text",value:F,onChange:function(e){return P(e.target.value)},className:"form-control form-control-lg",placeholder:"Ask your document a question?"})}),(0,p.jsx)(k.Z,{placement:"top",delay:{show:250,hide:400},overlay:function(e){return(0,p.jsx)(E.Z,(0,o.Z)((0,o.Z)({id:"button-tooltip"},e),{},{children:T?"Stop":"Send"}))},children:(0,p.jsx)(v.Z,{disabled:!F&&!T,className:["btn btn-sm send",T?"btn-danger":"btn-primary"].join(" "),title:T?"Stop":"Send",onClick:function(e){if(T)return se(e);ne(e)},children:T?(0,p.jsx)(h.Z,{icon:z.Z}):(0,p.jsx)(h.Z,{icon:Q.Z})})}),(0,p.jsx)(k.Z,{placement:"top",delay:{show:250,hide:400},overlay:function(e){return(0,p.jsx)(E.Z,(0,o.Z)((0,o.Z)({id:"button-tooltip"},e),{},{children:"Clear Chat History"}))},children:(0,p.jsx)(v.Z,{className:"btn btn-outline-secondary clear-history",isLoading:X,title:"Clear Chat History",onClick:ie,children:(0,p.jsx)(h.Z,{icon:x.Z})})})]}),(0,p.jsx)("div",{className:"container px-4 mb-2",children:(0,p.jsxs)("small",{children:[(0,p.jsx)("b",{children:"Note:"})," if the chat bot didn't know how to access to document or where to look up, just tell him \"",(0,p.jsx)("b",{children:(0,p.jsx)("i",{children:"from document?"})}),'".']})})]}))}var J=s(7689),U=s(1087),I=s(5480),G=s(6334),R=s(9396),F=s(8241),P=s(319),Y=s(5867),W=function(e){var n=e.files,s=e.setProgress,i=e.setIsSuccessUpload,t=e.resetDropzone,r=(e.name,e.createChatRoom),a=e.setProcessing,c=e.subscription,l=e.isDemo,u=e.demoSubscription,d=e.setDemoSubscription,m=e.queryClient;if(l&&u.pdfs<=0)return t(),S.Am.warning("The demo quota is exceeded, please wait 12 hours \ud83d\ude4f");if(!l){if(1!==(null===c||void 0===c?void 0:c.status))return t(),S.Am.warning("You need a valid subscription to continue.");if((null===c||void 0===c?void 0:c.pdfs)<=0)return t(),S.Am.warning("You have reached the maximum number of document uploads.")}(0,R.cT)("user/chat",n[0],{onUploadProgress:function(e){var n=e.loaded/e.total*100;s(n),n>=100&&a(!0)}}).then((function(e){var n;if(!e.data||null!==(n=e.data)&&void 0!==n&&n.errors){var s;S.Am.error(null===(s=e.data)||void 0===s?void 0:s.message),t()}else{var a=e.data.chat_room;r(a.uuid,a.title),i(!0),setTimeout((function(){t()}),5e3),l&&d((function(e){return(0,o.Z)((0,o.Z)({},e),{},{pdfs:e.pdfs-1})})),m.invalidateQueries("user.subscription")}})).catch((function(e){var n,s;422===e.response.status||400==e.response.status?S.Am.warning(null===(n=e.response)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.message):S.Am.error(e.message);t()})).finally((function(){a(!1)}))},T=function(e){S.Am.error("Invalid document!")};function H(){var e=(0,d.FO)().isDemo,n=(0,d.v$)("demo_sub",{pdfs:2,questions:10,created_at:(new Date).getTime()}),s=(0,t.Z)(n,2),o=s[0],j=s[1],x=e?o():null,g=(0,d.Wn)().isExtendedLicense,v=(0,u.useState)(!1),A=(0,t.Z)(v,2),b=A[0],C=A[1],D=(0,u.useState)(!1),w=(0,t.Z)(D,2),M=w[0],k=(w[1],(0,d.OR)("resize",window.innerWidth,(function(){return window.innerWidth}))),E=(0,t.Z)(k,2),z=E[0],Q=(E[1],(0,I.A)().user),R=(0,Z.SI)(),H=R.isLoading,K=R.subscription,q=(0,N.useQueryClient)(),X=(0,J.s0)(),L=(0,J.UO)().uuid,V=(0,u.useState)(L),_=(0,t.Z)(V,2),$=_[0],ee=_[1],ne=(0,Z.z$)(),se=ne.isLoading,ie=ne.isError,te=ne.error,oe=ne.userChatRoomList,re=(0,u.useState)(!1),ae=(0,t.Z)(re,2),ce=ae[0],le=ae[1];(0,u.useEffect)((function(){L!==$&&X("/playground/".concat($))}),[$]);var ue=(0,u.useCallback)((function(e){ee(e),X("/playground/".concat(e))}),[L]),de=(0,u.useCallback)((function(e,n){q.invalidateQueries("user.chat.list"),ee(e),X("/playground/".concat(e))}),[L]),me=(0,u.useCallback)((function(e,n){var s="";if(oe){var t,o=(0,i.Z)(oe);try{for(o.s();!(t=o.n()).done;){var r=t.value;if((null===r||void 0===r?void 0:r.uuid)!==e){s=null===r||void 0===r?void 0:r.uuid;break}}}catch(a){o.e(a)}finally{o.f()}}(0,y.U1)(e).then((function(e){204===e.status?(S.Am.success("Deleted successfully."),q.invalidateQueries("user.chat.list").then((function(){s&&ee(s)}))):S.Am.warning("Something went wrong!")})).catch((function(e){S.Am.error(e)})).finally((function(){n()}))}),[L,oe]);return(0,u.useEffect)((function(){var e,n;L&&$||void 0===oe||!Object.keys(oe).length?void 0===oe||Object.keys(oe).length||(ee(""),X("/playground")):(X("/playground/".concat(null===(e=oe[0])||void 0===e?void 0:e.uuid)),ee(null===(n=oe[0])||void 0===n?void 0:n.uuid))}),[L,oe]),(0,u.useEffect)((function(){(new Date).getTime()-(null===x||void 0===x?void 0:x.created_at)>432e5&&j({pdfs:2,questions:10,created_at:(new Date).getTime()})}),[]),ie&&S.Am.error(te),!Object.keys(Q).length||se||H?(0,p.jsx)(G.Z,{}):(0,p.jsx)(p.Fragment,{children:(0,p.jsxs)("main",{className:"playground",children:[(0,p.jsx)(l.YE,{width:"290px",toggled:b,collapsed:M,breakPoint:"md",onBackdropClick:function(){return C(!b)},backgroundColor:"",className:"",children:(0,p.jsxs)("div",{className:"playground-sidebar",children:[!(null===oe||void 0===oe||!oe.length)&&(K||x)&&(0,p.jsx)(c.Z,{onUpload:W,onError:T,name:"pdf-file",extraOnUploadProps:{createChatRoom:de,setProcessing:le,subscription:K,isDemo:e,demoSubscription:x,setDemoSubscription:j,queryClient:q},dropzoneOptions:{accept:(0,Y.G6)(),maxSize:52428800},children:ce?(0,p.jsx)("div",{className:"text-center",children:(0,p.jsxs)("b",{children:[(0,p.jsx)(O.Z,{size:"sm"})," Processing..."]})}):M?(0,p.jsx)(a.G,{icon:r.r8p}):(0,p.jsxs)("div",{className:"text-center",children:[(0,p.jsxs)("b",{children:[(0,p.jsx)(a.G,{icon:r.r8p})," New Chat"]}),(0,p.jsxs)("p",{children:["Drag & Drop your Document",(0,p.jsx)("br",{}),(0,p.jsxs)("small",{children:["(",(0,Y.IT)(),")"]})]})]})}),(0,p.jsx)("div",{className:"chat-labels-list my-3",children:null===oe||void 0===oe?void 0:oe.map((function(e,n){return(0,p.jsx)(f,{title:e.title,onClick:function(){return ue(e.uuid)},onDelete:function(n){return me(e.uuid,n)},active:e.uuid===$},n)}))}),(0,p.jsxs)("div",{className:"sidebar-bottom-section",children:[e&&(0,p.jsxs)(p.Fragment,{children:[((null===K||void 0===K?void 0:K.questions)<=20||(null===K||void 0===K?void 0:K.pdfs)<=10)&&(0,p.jsxs)(U.rU,{to:"/pricing",className:"btn btn-warning btn-lg btn-block",children:[(0,p.jsx)(h.Z,{icon:F.Z,stroke:1.5,size:30})," Upgrade"]}),(0,p.jsxs)("div",{className:"quota",children:[(0,p.jsx)("small",{children:"- Quota limited for demo only."}),(0,p.jsx)("br",{}),(0,p.jsx)("small",{children:"- Quota reset every 12 hours."}),(0,p.jsx)("h3",{className:"h6",children:"Quota:"}),(0,p.jsxs)("span",{children:[null===x||void 0===x?void 0:x.pdfs," PDFs"]}),(0,p.jsx)("br",{}),(0,p.jsxs)("span",{children:["Max PDF size: ",null===K||void 0===K?void 0:K.pdf_size,"MB/pdf"]}),(0,p.jsx)("br",{}),(0,p.jsxs)("span",{children:[null===x||void 0===x?void 0:x.questions," PDF Questions"]}),(0,p.jsx)("br",{})]})]}),K&&g&&!e&&(0,p.jsxs)(p.Fragment,{children:[((null===K||void 0===K?void 0:K.questions)<=20||(null===K||void 0===K?void 0:K.pdfs)<=10)&&(0,p.jsxs)(U.rU,{to:"/pricing",className:"btn btn-warning btn-lg btn-block",children:[(0,p.jsx)(h.Z,{icon:F.Z,stroke:1.5,size:30})," Upgrade"]}),(0,p.jsxs)("div",{className:"quota",children:[(0,p.jsx)("h3",{className:"h6",children:"Available Subscription Quota:"}),(0,p.jsxs)("span",{children:[null===K||void 0===K?void 0:K.pdfs," PDFs left."]}),(0,p.jsx)("br",{}),(0,p.jsxs)("span",{children:["Max PDF size: ",null===K||void 0===K?void 0:K.pdf_size,"MB/pdf."]}),(0,p.jsx)("br",{}),(0,p.jsxs)("span",{children:[null===K||void 0===K?void 0:K.questions," PDF Questions left."]}),(0,p.jsx)("br",{})]})]}),Q&&(0,p.jsxs)("div",{className:"profile",onClick:function(){return X("/account/settings")},children:[(0,p.jsx)(m.Z,{username:Q.username,size:45}),(0,p.jsxs)("div",{children:[(0,p.jsx)("b",{children:Q.username}),(0,p.jsx)("br",{}),(0,p.jsxs)("span",{children:["(",Q.email,")"]})]}),(0,p.jsx)("div",{className:"",children:(0,p.jsx)(a.G,{icon:r._tD})})]})]})]})}),(0,p.jsxs)("section",{className:"playground-chat-section",children:[z<=768&&(0,p.jsx)("button",{type:"button",onClick:function(){return C((function(e){return!e}))},className:"btn btn-light toggle-sidebar-button text-primary",children:(0,p.jsx)(a.G,{icon:r.Ljc})}),(0,p.jsxs)("section",{className:"d-flex flex-column",children:[g?K&&1==(null===K||void 0===K?void 0:K.status)||e?(null===K||void 0===K?void 0:K.questions)<=0?(0,p.jsxs)("div",{className:"d-flex flex-column justify-content-start p-5",children:["Your subscription has reached its maximum usage.",(0,p.jsx)(U.rU,{to:"/pricing",className:"btn btn-warning my-3",children:"Upgrade Now?"})]}):$&&(0,p.jsx)(B,{uuid:$},$):(0,p.jsxs)("div",{className:"d-flex flex-column justify-content-start p-5 mt-3",children:["You need to have a subscription in order to be able to use the Playground section.",(0,p.jsx)(U.rU,{to:"/pricing",className:"btn btn-warning my-3",children:"Get a subscription now?"})]}):$&&(0,p.jsx)(B,{uuid:$},$),!$&&(0,p.jsx)("div",{className:"d-flex justify-content-center align-items-center h-100",children:(0,p.jsx)("div",{className:"w-50",children:(K||x)&&(0,p.jsxs)("div",{className:"text-center",children:[(0,p.jsx)("h3",{children:"Upload your Document to chat with."}),(0,p.jsx)(c.Z,{onUpload:W,onError:T,name:"pdf-file",extraOnUploadProps:{createChatRoom:de,setProcessing:le,subscription:K,isDemo:e,demoSubscription:x,setDemoSubscription:j,queryClient:q},dropzoneOptions:{accept:(0,Y.G6)(),maxSize:52428800},children:ce?(0,p.jsx)("div",{className:"text-center",children:(0,p.jsxs)("b",{children:[(0,p.jsx)(O.Z,{size:"sm"})," Processing..."]})}):M?(0,p.jsx)(a.G,{icon:r.r8p}):(0,p.jsxs)("div",{className:"text-center",children:[(0,p.jsxs)("b",{children:[(0,p.jsx)(h.Z,{icon:P.Z,size:40}),(0,p.jsx)("br",{}),"Upload you Document",(0,p.jsx)("br",{}),"(",(0,Y.IT)(),")"]}),(0,p.jsx)("p",{children:"(Drag & Drop)"})]})})]})})})]})]})]})})}}}]);
//# sourceMappingURL=553.15b49782.chunk.js.map